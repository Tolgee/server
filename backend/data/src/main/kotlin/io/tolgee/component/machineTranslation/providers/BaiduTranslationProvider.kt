package io.tolgee.component.machineTranslation.providers

import io.tolgee.configuration.tolgee.machineTranslation.BaiduMachineTranslationProperties
import org.springframework.beans.factory.config.ConfigurableBeanFactory
import org.springframework.context.annotation.Scope
import org.springframework.stereotype.Component

@Component
@Scope(value = ConfigurableBeanFactory.SCOPE_SINGLETON)
class BaiduTranslationProvider(
  private val baiduMachineTranslationProperties: BaiduMachineTranslationProperties,
  private val baiduApiService: BaiduApiService
) : AbstractMtValueProvider() {

  override val isEnabled: Boolean
    get() = !baiduMachineTranslationProperties.appId.isNullOrEmpty() &&
      !baiduMachineTranslationProperties.appSecret.isNullOrEmpty()

  override fun translateViaProvider(text: String, sourceTag: String, targetTag: String): String? {
    return baiduApiService.translate(text, getLanguageTag(sourceTag), getLanguageTag(targetTag))
  }

  override fun calculateProviderPrice(text: String): Int {
    return text.length * 100
  }

  fun getLanguageTag(tag: String): String {
    return languageTagMap[tag.lowercase()] ?: tag.lowercase()
  }

  override val supportedLanguages = arrayOf(
    "yue",
    "yue-hans",
    "yue-hans-cn",
    "kor",
    "ko",
    "ko-kr",
    "th",
    "th-th",
    "pt",
    "pt-pt",
    "pt-br",
    "el",
    "el-gr",
    "bul",
    "bg",
    "bg-bg",
    "fin",
    "fi",
    "fi-fi",
    "slo",
    "sk",
    "sk-sk",
    "cht",
    "zh-hant",
    "zh-hant-hk",
    "zh-hant-mo",
    "zh-hant-tw",
    "zh-tw",
    "zh",
    "zh-hans",
    "zh-hans-cn",
    "zh-hans-sg",
    "zh-hans-hk",
    "zh-hans-mo",
    "wyw",
    "fra",
    "fr",
    "fr-fr",
    "ara",
    "ar",
    "de",
    "de-de",
    "nl",
    "nl",
    "nl-nl",
    "est",
    "et",
    "et-ee",
    "cs",
    "cs-cz",
    "swe",
    "sl",
    "sl-si",
    "sv",
    "sv-se",
    "vie",
    "vi",
    "vi-vn",
    "en",
    "en-us",
    "en-gb",
    "jp",
    "ja",
    "ja-jp",
    "spa",
    "es",
    "es-es",
    "ru",
    "ru-ru",
    "it",
    "it-it",
    "pl",
    "pl-pl",
    "dan",
    "da",
    "da-dk",
    "rom",
    "ro",
    "ro-ro",
    "hu",
    "hu-hu",
    "sq",
    "sq-al",
    "an",
    "ay",
    "os",
    "or",
    "or-in",
    "ga",
    "ga-ie",
    "ar-dz",
    "am",
    "am-et",
    "az",
    "et",
    "et-ee",
    "om",
    "om-et",
    "oc",
    "ak",
    "ak-gh",
    "as",
    "oj",
    "ba",
    "be",
    "be-by",
    "bem",
    "bal",
    "bho",
    "fa",
    "fa-ir",
    "eu",
    "eu-es",
    "ber",
    "se",
    "se-se",
    "bli",
    "is",
    "is-is",
    "br",
    "br-fr",
    "pam",
    "ped",
    "bi",
    "bs",
    "cv",
    "ts",
    "da",
    "da-dk",
    "sha",
    "log",
    "tet",
    "tt",
    "dv",
    "sa",
    "sa-in",
    "fo",
    "fo-fo",
    "fil",
    "fil-ph",
    "fri",
    "ff",
    "gla",
    "hkm",
    "gu",
    "gn",
    "kg",
    "kl",
    "kl-gl",
    "grc",
    "gra",
    "ups",
    "ka",
    "ka-ge",
    "eno",
    "hak",
    "ha",
    "ht",
    "hup",
    "mot",
    "ky",
    "ky-kg",
    "ca",
    "gl",
    "fr-ca",
    "kab",
    "kah",
    "co",
    "tlh",
    "ks",
    "kn",
    "kw",
    "cr",
    "hr",
    "hr-hr",
    "kok",
    "kr",
    "xh",
    "cri",
    "qu",
    "ku",
    "la",
    "lag",
    "ln",
    "ruy",
    "rm",
    "lo",
    "lv",
    "lg",
    "rw",
    "li",
    "lb",
    "lt",
    "loj",

  )

  // https://fanyi-api.baidu.com/doc/21
  val languageTagMap = mapOf(
    // "yue"
    // "kor"
    "ko" to "kor",
    // "th"
    // "pt"
    // "el"
    // "bul"
    "bg" to "bul",
    // "fin"
    "fi" to "fin",
    // "slo"
    "sl" to "slo",
    // "sk"
    // "cht"
    "zh-hant" to "cht",
    "zh-tw" to "cht",
    // "zh"
    "zh-hans" to "zh",
    // "wyw"
    // "fra"
    "fr" to "fra",
    // "ara"
    "ar" to "ara",
    // "de"
    // "nl"
    // "est"
    "et" to "est",
    // "cs"
    // "swe"
    "sv" to "swe",
    // "vie"
    "vi" to "vie",
    // "en"
    // "jp"
    "ja" to "jp",
    // "spa"
    "es" to "spa",
    // "ru"
    // "it"
    // "pl"
    // "dan"
    "da" to "dan",
    // "rom"
    "ro" to "rom",
    // "hu"
    "sq" to "alb",
    "an" to "arg",
    "ay" to "aym",
    "os" to "oss",
    "or" to "ori",
    "ga" to "gle",
    "ar-dz" to "arq",
    "am" to "amh",
    "az" to "aze",
    "et" to "est",
    "om" to "orm",
    "oc" to "oci",
    "ak" to "aka",
    "as" to "asm",
    "oj" to "oji",
    "ba" to "bak",
    "be" to "bel",
    "fa" to "per",
    "eu" to "baq",
    "se" to "sme",
    "is" to "ice",
    "br" to "bre",
    "pt-br" to "pot",
    "bi" to "bis",
    "bs" to "bos",
    "cv" to "chv",
    "ts" to "tso",
    "da" to "dan",
    "tt" to "tat",
    "dv" to "div",
    "sa" to "san",
    "fo" to "fao",
    "ff" to "ful",
    "gu" to "guj",
    "gn" to "grn",
    "kg" to "kon",
    "kl" to "kal",
    "grc" to "gra",
    "ka" to "geo",
    "ha" to "hau",
    "ky" to "kir",
    "ca" to "cat",
    "gl" to "glg",
    "fr-ca" to "frn",
    "co" to "cos",
    "tlh" to "kli",
    "ks" to "kas",
    "kn" to "kan",
    "kw" to "cor",
    "cr" to "cre",
    "hr" to "hrv",
    "kr" to "kau",
    "xh" to "xho",
    "qu" to "que",
    "ku" to "kur",
    "la" to "lat",
    "ln" to "lin",
    "rm" to "roh",
    "lo" to "lao",
    "lv" to "lav",
    "lg" to "lug",
    "rw" to "kin",
    "rom" to "ro",
    "li" to "lim",
    "lb" to "ltz",
    "lt" to "lit",

  )
}
